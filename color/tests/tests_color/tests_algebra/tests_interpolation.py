#!/usr/bin/env python
# -*- coding: utf-8 -*-

"""
**tests_interpolation.py**

**Platform:**
    Windows, Linux, Mac Os X.

**Description:**
    Defines units tests for :mod:`color.algebra.interpolation` module.

**Others:**

"""

from __future__ import unicode_literals

import sys
import numpy

if sys.version_info[:2] <= (2, 6):
    import unittest2 as unittest
else:
    import unittest

import color.algebra.interpolation

__author__ = "Thomas Mansencal"
__copyright__ = "Copyright (C) 2013 - 2014 - Thomas Mansencal"
__license__ = "GPL V3.0 - http://www.gnu.org/licenses/"
__maintainer__ = "Thomas Mansencal"
__email__ = "thomas.mansencal@gmail.com"
__status__ = "Production"

__all__ = ["POINTS_DATA_A",
           "INTERPOLATED_POINTS_DATA_A_10_SAMPLES",
           "POINTS_DATA_B",
           "INTERPOLATED_POINTS_DATA_B_5_SAMPLES",
           "INTERPOLATED_POINTS_DATA_B_2_SAMPLES",
           "TestSpragueInterpolation"]

POINTS_DATA_A = numpy.array([9.3700,
                             12.3200,
                             12.4600,
                             9.5100,
                             5.9200,
                             4.3300,
                             4.2900,
                             3.8800,
                             4.5100,
                             10.9200,
                             27.5000,
                             49.6700,
                             69.5900,
                             81.7300,
                             88.1900,
                             86.0500])

INTERPOLATED_POINTS_DATA_A_10_SAMPLES = numpy.array([9.37,
                                                     9.72075073,
                                                     10.06936191,
                                                     10.4114757,
                                                     10.7430227,
                                                     11.06022653,
                                                     11.35960827,
                                                     11.637991,
                                                     11.89250427,
                                                     12.1205886,
                                                     12.32,
                                                     12.48873542,
                                                     12.62489669,
                                                     12.7270653,
                                                     12.79433478,
                                                     12.82623598,
                                                     12.82266243,
                                                     12.78379557,
                                                     12.71003009,
                                                     12.60189921,
                                                     12.46,
                                                     12.28440225,
                                                     12.074048,
                                                     11.829765,
                                                     11.554432,
                                                     11.25234375,
                                                     10.928576,
                                                     10.5883505,
                                                     10.2364,
                                                     9.87633325,
                                                     9.51,
                                                     9.13692962,
                                                     8.756208,
                                                     8.36954763,
                                                     7.980976,
                                                     7.59601562,
                                                     7.220864,
                                                     6.86157362,
                                                     6.523232,
                                                     6.20914162,
                                                     5.92,
                                                     5.654602,
                                                     5.414496,
                                                     5.20073875,
                                                     5.012944,
                                                     4.8496875,
                                                     4.708912,
                                                     4.58833225,
                                                     4.48584,
                                                     4.399909,
                                                     4.33,
                                                     4.27757887,
                                                     4.245952,
                                                     4.23497388,
                                                     4.240992,
                                                     4.25804688,
                                                     4.279072,
                                                     4.29709387,
                                                     4.306432,
                                                     4.30389887,
                                                     4.29,
                                                     4.26848387,
                                                     4.240432,
                                                     4.20608887,
                                                     4.166032,
                                                     4.12117188,
                                                     4.072752,
                                                     4.02234887,
                                                     3.971872,
                                                     3.92356387,
                                                     3.88,
                                                     3.84319188,
                                                     3.813184,
                                                     3.79258487,
                                                     3.786912,
                                                     3.80367187,
                                                     3.85144,
                                                     3.93894087,
                                                     4.074128,
                                                     4.26326387,
                                                     4.51,
                                                     4.81362075,
                                                     5.170288,
                                                     5.5822515,
                                                     6.05776,
                                                     6.60890625,
                                                     7.249472,
                                                     7.992773,
                                                     8.849504,
                                                     9.82558375,
                                                     10.92,
                                                     12.12700944,
                                                     13.448928,
                                                     14.88581406,
                                                     16.432832,
                                                     18.08167969,
                                                     19.822016,
                                                     21.64288831,
                                                     23.53416,
                                                     25.48793794,
                                                     27.5,
                                                     29.57061744,
                                                     31.699648,
                                                     33.88185481,
                                                     36.107776,
                                                     38.36511719,
                                                     40.640144,
                                                     42.91907456,
                                                     45.189472,
                                                     47.44163694,
                                                     49.67,
                                                     51.87389638,
                                                     54.052736,
                                                     56.20157688,
                                                     58.311984,
                                                     60.37335938,
                                                     62.374272,
                                                     64.30378787,
                                                     66.1528,
                                                     67.91535838,
                                                     69.59,
                                                     71.17616669,
                                                     72.662832,
                                                     74.04610481,
                                                     75.331712,
                                                     76.53183594,
                                                     77.661952,
                                                     78.73766606,
                                                     79.771552,
                                                     80.76998919,
                                                     81.73,
                                                     82.64375688,
                                                     83.51935227,
                                                     84.35919976,
                                                     85.15567334,
                                                     85.89451368,
                                                     86.55823441,
                                                     87.12952842,
                                                     87.59467414,
                                                     87.94694187,
                                                     88.19,
                                                     88.33345751,
                                                     88.37111372,
                                                     88.30221714,
                                                     88.13600972,
                                                     87.88846516,
                                                     87.57902706,
                                                     87.2273472,
                                                     86.85002373,
                                                     86.45733945,
                                                     86.05])

POINTS_DATA_B = [4.16,
                 4.22,
                 4.23,
                 4.16,
                 4.11,
                 4.26,
                 4.43,
                 4.47,
                 4.53,
                 4.56,
                 4.92,
                 6.05,
                 7.55,
                 9.35,
                 10.81,
                 11.12,
                 10.74,
                 9.73,
                 8.51,
                 7.52,
                 6.71,
                 6.22,
                 5.88,
                 5.54,
                 5.27,
                 5.11,
                 5.1,
                 5.04,
                 5.75,
                 8.08,
                 11.75]

INTERPOLATED_POINTS_DATA_B_5_SAMPLES = [4.16,
                                        4.17372402,
                                        4.18697807,
                                        4.19926216,
                                        4.21036616,
                                        4.22,
                                        4.22771185,
                                        4.23333183,
                                        4.2361319,
                                        4.23517198,
                                        4.23,
                                        4.220992,
                                        4.208512,
                                        4.193392,
                                        4.176832,
                                        4.16,
                                        4.143088,
                                        4.125792,
                                        4.111536,
                                        4.10528,
                                        4.11,
                                        4.1252,
                                        4.151136,
                                        4.185072,
                                        4.222448,
                                        4.26,
                                        4.298064,
                                        4.336832,
                                        4.37376,
                                        4.405488,
                                        4.43,
                                        4.44712,
                                        4.45592,
                                        4.45952,
                                        4.46312,
                                        4.47,
                                        4.480096,
                                        4.4948,
                                        4.511104,
                                        4.523728,
                                        4.53,
                                        4.532256,
                                        4.531984,
                                        4.532992,
                                        4.5408,
                                        4.56,
                                        4.5912,
                                        4.634192,
                                        4.696784,
                                        4.789856,
                                        4.92,
                                        5.086976,
                                        5.292544,
                                        5.529232,
                                        5.78448,
                                        6.05,
                                        6.325952,
                                        6.609712,
                                        6.904512,
                                        7.216992,
                                        7.55,
                                        7.898912,
                                        8.260272,
                                        8.627952,
                                        8.993632,
                                        9.35,
                                        9.694976,
                                        10.027872,
                                        10.335568,
                                        10.600064,
                                        10.81,
                                        10.964896,
                                        11.061328,
                                        11.10896,
                                        11.124832,
                                        11.12,
                                        11.092736,
                                        11.04456,
                                        10.972944,
                                        10.872288,
                                        10.74,
                                        10.5796,
                                        10.393424,
                                        10.185888,
                                        9.963072,
                                        9.73,
                                        9.488192,
                                        9.238928,
                                        8.988144,
                                        8.74344,
                                        8.51,
                                        8.289232,
                                        8.083664,
                                        7.890416,
                                        7.703648,
                                        7.52,
                                        7.341056,
                                        7.166816,
                                        7.000496,
                                        6.847216,
                                        6.71,
                                        6.587904,
                                        6.480816,
                                        6.386288,
                                        6.30032,
                                        6.22,
                                        6.145408,
                                        6.076448,
                                        6.010928,
                                        5.946048,
                                        5.88,
                                        5.812528,
                                        5.743008,
                                        5.672848,
                                        5.604608,
                                        5.54,
                                        5.478736,
                                        5.420928,
                                        5.3668,
                                        5.316432,
                                        5.27,
                                        5.227536,
                                        5.18864,
                                        5.154784,
                                        5.128208,
                                        5.11,
                                        5.10096,
                                        5.103904,
                                        5.111568,
                                        5.112272,
                                        5.1,
                                        5.078864,
                                        5.051008,
                                        5.026112,
                                        5.018656,
                                        5.04,
                                        5.091776,
                                        5.175392,
                                        5.303168,
                                        5.491184,
                                        5.75,
                                        6.07882565,
                                        6.47665623,
                                        6.94384681,
                                        7.47946917,
                                        8.08,
                                        8.73844601,
                                        9.44591801,
                                        10.19215824,
                                        10.96501435,
                                        11.75]

INTERPOLATED_POINTS_DATA_B_2_SAMPLES = [4.16,
                                        4.19325695,
                                        4.22,
                                        4.23514634,
                                        4.23,
                                        4.20121094,
                                        4.16,
                                        4.11796875,
                                        4.11,
                                        4.16738281,
                                        4.26,
                                        4.35574219,
                                        4.43,
                                        4.45804687,
                                        4.47,
                                        4.50308594,
                                        4.53,
                                        4.53199219,
                                        4.56,
                                        4.66234375,
                                        4.92,
                                        5.40777344,
                                        6.05,
                                        6.7553125,
                                        7.55,
                                        8.44382812,
                                        9.35,
                                        10.18601562,
                                        10.81,
                                        11.09019531,
                                        11.12,
                                        11.01203125,
                                        10.74,
                                        10.29195313,
                                        9.73,
                                        9.11324219,
                                        8.51,
                                        7.98585938,
                                        7.52,
                                        7.08234375,
                                        6.71,
                                        6.43222656,
                                        6.22,
                                        6.0434375,
                                        5.88,
                                        5.70785156,
                                        5.54,
                                        5.39339844,
                                        5.27,
                                        5.1709375,
                                        5.11,
                                        5.10789062,
                                        5.1,
                                        5.03730469,
                                        5.04,
                                        5.23273437,
                                        5.75,
                                        6.70159409,
                                        8.08,
                                        9.81490206,
                                        11.75]


class TestSpragueInterpolation(unittest.TestCase):
    """
    Defines :func:`color.algebra.interpolation.sprague_interpolation` definition units tests methods.
    """

    def test_sprague_interpolation(self):
        """
        Tests :func:`color.algebra.interpolation.sprague_interpolation` definition.
        """

        numpy.testing.assert_almost_equal(color.algebra.interpolation.sprague_interpolation(POINTS_DATA_A, 10),
                                          INTERPOLATED_POINTS_DATA_A_10_SAMPLES,
                                          decimal=7)
        numpy.testing.assert_almost_equal(color.algebra.interpolation.sprague_interpolation(POINTS_DATA_B, 5),
                                          INTERPOLATED_POINTS_DATA_B_5_SAMPLES,
                                          decimal=7)
        numpy.testing.assert_almost_equal(color.algebra.interpolation.sprague_interpolation(POINTS_DATA_B, 2),
                                          INTERPOLATED_POINTS_DATA_B_2_SAMPLES,
                                          decimal=7)


if __name__ == "__main__":
    unittest.main()
